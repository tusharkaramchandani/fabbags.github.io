(function(b){function u(b){for(var d=1;d<arguments.length;d++)b=b.replace("%"+(d-1),arguments[d]);return b}function I(f,d){var c=b("img.visible",f),k,g=null,l=null,h=null,m=null,n=null,r=null,v,D=0,y,z,E=0,F=0,p=0,q=0,G=0,B,C,A=this,H;setTimeout(function(){if(null===l){var c=f.width();f.parent().append(u('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',c/3,c/2-c/6));b("cloud-zoom-loading",f.parent()).css("opacity",.5)}},200);
this.removeBits=function(){h&&(h.remove(),h=null);m&&(m.remove(),m=null);n&&(n.remove(),n=null);null!==r&&(r.remove(),r=null);b(".cloud-zoom-loading",f.parent()).remove()};this.destroy=function(){f.data("zoom",null);l&&(l.unbind(),l.remove(),l=null);g&&(g.remove(),g=null);this.removeBits()};this.fadedOut=function(){g&&(g.remove(),g=null);this.removeBits()};this.controlLoop=function(){if(h){var b=B-c.offset().left-.5*y>>0,e=C-c.offset().top-.5*z>>0;0>b?b=0:b>c.outerWidth()-y&&(b=c.outerWidth()-y);
0>e?e=0:e>c.outerHeight()-z&&(e=c.outerHeight()-z);h.css({left:b,top:e});h.css("background-position",-b+"px "+-e+"px");E=b/c.outerWidth()*v.width>>0;F=e/c.outerHeight()*v.height>>0;q+=(E-q)/d.smoothMove;p+=(F-p)/d.smoothMove;g.css("background-position",-(q>>0)+"px "+(-(p>>0)+"px"))}D=setTimeout(function(){A.controlLoop()},30)};this.init2=function(b,c){G++;1===c&&(v=b);2===G&&this.init()};this.init=function(){b(".cloud-zoom-loading",f.parent()).remove();var k=b("<div class='mousetrap' style='background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)'></div>");
l=f.parent().append(k).find(":last");l=b(".mousetrap",f.parent());l.css({width:c.outerWidth(),height:c.outerHeight(),top:0,left:0,position:"absolute",zIndex:9999});l.bind("mousemove",this,function(b){B=b.pageX;C=b.pageY});l.bind("mouseleave",this,function(b){clearTimeout(D);h&&h.fadeOut(299);m&&m.fadeOut(299);n&&n.fadeOut(299);g.fadeOut(300,function(){A.fadedOut()});return!1});l.bind("mouseenter",this,function(e){B=e.pageX;C=e.pageY;H=e.data;g&&(g.stop(!0,!1),g.remove());e=d.adjustX;var k=d.adjustY,
p=c.outerWidth(),q=c.outerHeight(),w=d.zoomWidth,x=d.zoomHeight;"auto"==d.zoomWidth&&(w=p);"auto"==d.zoomHeight&&(x=q);var t=f.parent();switch(d.position){case "top":k-=x;break;case "right":e+=p;break;case "bottom":k+=q;break;case "left":e-=w;break;case "inside":w=p;x=q;break;default:t=b("#"+d.position),t.length?(w=t.innerWidth(),x=t.innerHeight()):(t=f,e+=p,k+=q)}g=t.append(u('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',
e,k,w,x,v.src)).find(":last");g=b(".cloud-zoom-big",t);c.attr("title")&&d.showTitle&&(g.append(u('<div class="cloud-zoom-title">%0</div>',c.attr("title"))),b(".cloud-zoom-title",g).css("opacity",d.titleOpacity));b.browser.msie&&7>b.browser.version&&(r=b('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:e,top:k,zIndex:99,width:w,height:x}).insertBefore(g));g.fadeIn(500);h&&(h.remove(),h=null);y=c.outerWidth()/v.width*g.width();z=c.outerHeight()/v.height*g.height();h=f.append(u("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",
y,z)).find(":last");h=b(".cloud-zoom-lens",f);l.css("cursor",h.css("cursor"));e=!1;d.tint&&(h.css("background",'url("'+c.attr("src")+'")'),m=f.append(u('<div class="cloud-zoom-tint" style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',c.outerWidth(),c.outerHeight(),d.tint)).find(":last"),m=b(".cloud-zoom-tint",f),m.css("opacity",d.tintOpacity),e=!0,m.fadeIn(500));d.softFocus&&(h.css("background",'url("'+c.attr("src")+'")'),f.append(u('<div class="cloud-zoom-soft" style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',
c.outerWidth()-2,c.outerHeight()-2,d.tint)),n=b(".cloud-zoom-soft",f),n.css("background",'url("'+c.attr("src")+'")'),n.css("opacity",.5),e=!0,n.fadeIn(500));e||h.css("opacity",d.lensOpacity);"inside"!==d.position&&h.fadeIn(500);H.controlLoop()})};k=new Image;b(k).load(function(){A.init2(this,0)});k.src=c.attr("src");k=new Image;b(k).load(function(){A.init2(this,1)});k.src=f.attr("href")}var r=document.getElementsByTagName("script"),J=r[r.length-1].src.lastIndexOf("/");r[r.length-1].src.slice(0,J);
b(document).ready(function(){b(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()});b.fn.CloudZoom=function(f){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}this.each(function(){var c,d;eval("var\ta = {"+b(this).attr("rel")+"}");c=a;b(this).is(".cloud-zoom")?(b(this).css({position:"relative",display:"block"}),b("img",b(this)).css({display:"block"}),"wrap"!=b(this).parent().attr("id")&&b(this).wrap('<div id="wrap" style="top:0px;z-index:9999;position:relative;"></div>'),d=b.extend({},
b.fn.CloudZoom.defaults,f),d=b.extend({},d,c),b(this).data("zoom",new I(b(this),d))):b(this).is(".cloud-zoom-gallery")&&(d=b.extend({},c,f),b(this).data("relOpts",d),b(this).bind("click",b(this),function(c){var d=c.data.data("relOpts");b("#"+d.useZoom).data("zoom").destroy();b("#"+d.useZoom).attr("href",c.data.attr("href"));$images=b("#"+d.useZoom+" img");$firstImage=$images.eq(0);$images.removeClass("visible");$firstImage.addClass("visible").attr("src",c.data.data("relOpts").smallImage);b("#"+c.data.data("relOpts").useZoom).CloudZoom();
return!1}))});return this};b.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,adjustY:0}})(jQuery);